<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Security Testing Demo</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #0e173b 0%, #242826 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .header {
            text-align: center;
            color: #eed307;
            margin-bottom: 40px;
        }
        
        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }
        
        .warning {
            background: hsl(62, 100%, 71%);
            color: rgb(27, 8, 5);
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 30px;
            text-align: center;
            font-weight: bold;
        }
        
        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .card {
            background: rgb(10, 151, 194);
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        
        .card h2 {
            color: #0b0d01;
            margin-bottom: 15px;
            font-size: 1.5em;
        }
        
        .vulnerability-tag {
            display: inline-block;
            background: #ff6b6b;
            color: white;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.8em;
            margin-bottom: 15px;
        }
        
        input, button {
            width: 100%;
            padding: 12px;
            margin: 8px 0;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 1em;
        }
        
        button {
            background: #667eea;
            color: white;
            border: none;
            cursor: pointer;
            font-weight: bold;
            transition: background 0.3s;
        }
        
        button:hover {
            background: #5568d3;
        }
        
        .result {
            margin-top: 15px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 6px;
            font-family: monospace;
            font-size: 0.9em;
            max-height: 200px;
            overflow-y: auto;
            display: none;
        }
        
        .result.show {
            display: block;
        }
        
        .result.success {
            border-left: 4px solid #51cf66;
        }
        
        .result.error {
            border-left: 4px solid #ff6b6b;
        }
        
        .hint {
            background: #fff3cd;
            padding: 10px;
            border-radius: 6px;
            margin-top: 10px;
            font-size: 0.9em;
            color: #856404;
        }
        
        .exploit-examples {
            background: #e7f5ff;
            padding: 15px;
            border-radius: 6px;
            margin-top: 15px;
        }
        
        .exploit-examples h3 {
            color: #1864ab;
            font-size: 1em;
            margin-bottom: 10px;
        }
        
        .exploit-examples code {
            background: white;
            padding: 2px 6px;
            border-radius: 3px;
            font-size: 0.85em;
            display: block;
            margin: 5px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Security Testing Demo</h1>
            <p>Demonstrating OWASP Top 10 Vulnerabilities</p>
        </div>
        
        <div class="warning">
            WARNING: Educational purposes only! This application contains intentional security vulnerabilities.
        </div>
        
        <div class="grid">
            <!-- SQL Injection -->
            <div class="card">
                <h2>SQL Injection</h2>
                <span class="vulnerability-tag">OWASP A03</span>
                <form id="loginForm">
                    <input type="text" id="username" placeholder="Username" required>
                    <input type="password" id="password" placeholder="Password" required>
                    <button type="submit">Login</button>
                </form>
                <div id="loginResult" class="result"></div>
                <div class="exploit-examples">
                    <h3>Exploitation Hints:</h3>
                    <code>Username: admin' OR '1'='1</code>
                    <code>Password: anything</code>
                    <code>Or try: admin'--</code>
                </div>
            </div>
            
            <!-- XSS -->
            <div class="card">
                <h2>Cross-Site Scripting (XSS)</h2>
                <span class="vulnerability-tag">OWASP A03</span>
                <form id="searchForm">
                    <input type="text" id="searchQuery" placeholder="Search products...">
                    <button type="submit">Search</button>
                </form>
                <div id="searchResult" class="result"></div>
                <div class="exploit-examples">
                    <h3>Exploitation Hints:</h3>
                    <code>&lt;script&gt;alert('XSS')&lt;/script&gt;</code>
                    <code>&lt;img src=x onerror=alert('XSS')&gt;</code>
                </div>
            </div>
            
            <!-- IDOR -->
            <div class="card">
                <h2>Insecure Direct Object Reference</h2>
                <span class="vulnerability-tag">OWASP A01</span>
                <form id="idorForm">
                    <input type="text" id="userId" placeholder="User ID (try 1, 2, 3)" value="1">
                    <button type="submit">Get User Data</button>
                </form>
                <div id="idorResult" class="result"></div>
                <div class="hint">
                    Try accessing other users' data by changing the ID. No authentication required!
                </div>
            </div>
            
            <!-- Broken Authentication -->
            <div class="card">
                <h2>Broken Authentication</h2>
                <span class="vulnerability-tag">OWASP A07</span>
                <form id="adminForm">
                    <input type="text" id="adminToken" placeholder="JWT Token (optional)" value="">
                    <button type="submit">Access Admin Panel</button>
                </form>
                <div id="adminResult" class="result"></div>
                <div class="exploit-examples">
                    <h3>Exploitation Hints:</h3>
                    <code>Try crafting a JWT with "alg":"none"</code>
                    <code>Or modify the role in the payload</code>
                </div>
            </div>
            
            <!-- Sensitive Data Exposure -->
            <div class="card">
                <h2>Sensitive Data Exposure</h2>
                <span class="vulnerability-tag">OWASP A02</span>
                <button id="configBtn">View Configuration</button>
                <div id="configResult" class="result"></div>
                <div class="hint">
                    Click to see what sensitive information is exposed through the API.
                </div>
            </div>
            
            <!-- Mass Assignment -->
            <div class="card">
                <h2>Mass Assignment</h2>
                <span class="vulnerability-tag">OWASP A04</span>
                <form id="registerForm">
                    <input type="text" id="regUsername" placeholder="Username">
                    <input type="password" id="regPassword" placeholder="Password">
                    <input type="email" id="regEmail" placeholder="Email">
                    <input type="text" id="regRole" placeholder="Role (try 'admin')" value="user">
                    <button type="submit">Register</button>
                </form>
                <div id="registerResult" class="result"></div>
                <div class="hint">
                    Try setting role to 'admin' during registration!
                </div>
            </div>
        </div>
    </div>
    
    <script>
        // SQL Injection - Login
        document.getElementById('loginForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            
            try {
                const res = await fetch('/api/login', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ username, password })
                });
                
                const data = await res.json();
                const resultDiv = document.getElementById('loginResult');
                resultDiv.className = 'result show ' + (data.success ? 'success' : 'error');
                resultDiv.innerHTML = `<pre>${JSON.stringify(data, null, 2)}</pre>`;
                
                if (data.token) {
                    localStorage.setItem('token', data.token);
                }
            } catch (err) {
                console.error(err);
            }
        });
        
        // XSS - Search
        document.getElementById('searchForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const query = document.getElementById('searchQuery').value;
            
            try {
                const res = await fetch(`/api/search?q=${encodeURIComponent(query)}`);
                const data = await res.json();
                
                const resultDiv = document.getElementById('searchResult');
                resultDiv.className = 'result show success';
                // Intentionally rendering unsanitized HTML for XSS demo
                resultDiv.innerHTML = `
                    <strong>Search for: ${data.searchTerm}</strong><br>
                    <pre>${JSON.stringify(data.results, null, 2)}</pre>
                `;
            } catch (err) {
                console.error(err);
            }
        });
        
        // IDOR - User Data
        document.getElementById('idorForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const userId = document.getElementById('userId').value;
            
            try {
                const res = await fetch(`/api/user/${userId}`);
                const data = await res.json();
                
                const resultDiv = document.getElementById('idorResult');
                resultDiv.className = 'result show ' + (res.ok ? 'success' : 'error');
                resultDiv.innerHTML = `<pre>${JSON.stringify(data, null, 2)}</pre>`;
            } catch (err) {
                console.error(err);
            }
        });
        
        // Broken Auth - Admin Access
        document.getElementById('adminForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            let token = document.getElementById('adminToken').value;
            
            if (!token) {
                token = localStorage.getItem('token') || '';
            }
            
            try {
                const res = await fetch('/api/admin', {
                    headers: { 'Authorization': `Bearer ${token}` }
                });
                
                const data = await res.json();
                const resultDiv = document.getElementById('adminResult');
                resultDiv.className = 'result show ' + (res.ok ? 'success' : 'error');
                resultDiv.innerHTML = `<pre>${JSON.stringify(data, null, 2)}</pre>`;
            } catch (err) {
                console.error(err);
            }
        });
        
        // Sensitive Data Exposure
        document.getElementById('configBtn').addEventListener('click', async () => {
            try {
                const res = await fetch('/api/config');
                const data = await res.json();
                
                const resultDiv = document.getElementById('configResult');
                resultDiv.className = 'result show error';
                resultDiv.innerHTML = `<pre>${JSON.stringify(data, null, 2)}</pre>`;
            } catch (err) {
                console.error(err);
            }
        });
        
        // Mass Assignment - Register
        document.getElementById('registerForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const username = document.getElementById('regUsername').value;
            const password = document.getElementById('regPassword').value;
            const email = document.getElementById('regEmail').value;
            const role = document.getElementById('regRole').value;
            
            try {
                const res = await fetch('/api/register', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ username, password, email, role })
                });
                
                const data = await res.json();
                const resultDiv = document.getElementById('registerResult');
                resultDiv.className = 'result show ' + (data.success ? 'success' : 'error');
                resultDiv.innerHTML = `<pre>${JSON.stringify(data, null, 2)}</pre>`;
            } catch (err) {
                console.error(err);
            }
        });
    </script>
</body>
</html>
